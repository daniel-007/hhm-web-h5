function ajaxPost(e,t,a){$.ajax({type:"POST",url:e,data:t,timeout:15e3,success:function(e,t,o){e.status?a(null,e):a(e.msg,null)},error:function(t,o,n){console.error(e+" error: "+o+"##"+n),a("服务异常",null)}})}function ajaxPost(e,t,a){$.ajax({type:"POST",url:e,data:t,timeout:15e3,success:function(e,t,o){e.status?a(null,e):a(e.msg,null)},error:function(t,o,n){console.error(e+" error: "+o+"##"+n),a("服务异常",null)}})}function ajaxPost(e,t,a){$.ajax({type:"POST",url:e,data:t,timeout:15e3,success:function(e,t,o){e.status?a(null,e):a(e.msg,null)},error:function(t,o,n){console.error(e+" error: "+o+"##"+n),a("服务异常",null)}})}function getStoreName(e){ajaxPost("/users/getStoreName",{},function(t,a){e(t,a.storeName)})}require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min"},shim:{Vue:{exports:"Vue"}}}),require(["Vue"],function(e){"use strict";e.config.delimiters=["${","}"],e.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-address-select",function(t,a,o){new e({el:"#page-address-select",data:{}})}),$(document).on("pageInit","#page-address-edit",function(t,a,o){new e({el:"#page-address-edit",data:{}});$(o).on("click",".button",function(){window.history.back()}),$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button class="button button-link pull-right close-picker">        确定</button><h1 class="title">选择收货地址</h1></header>'})}),$.init()}),require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(e,t){"use strict";e.config.delimiters=["${","}"],e.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-book-confirm",function(t,a,o){var n=new e({el:"#page-book-confirm",data:{payment:1}});$(o).on("click","#submitBook",function(){return 1===n.payment?void(location.href="/book/pay-way"):2===n.payment?void(location.href="/book/complete"):void 0})}),$(document).on("pageInit","#page-book-complete",function(t,a,o){new e({el:"#page-book-complete",data:{}})}),$(document).on("pageInit","#page-book-pay-way",function(t,a,o){new e({el:"#page-book-pay-way",data:{}})}),$(document).on("pageInit","#page-book-detail",function(a,o,n){var i=t.getSearch(location);new e({el:"#page-book-detail",data:{type:parseInt(i.status)},computed:{bookStatus:function(){return 1===this.type?"待付款":2===this.type?"待审核":3===this.type?"已完成":4===this.type?"已取消":5===this.type?"已发货":6===this.type?"待发货":void 0},isNeedPay:function(){return 1===this.type},operateName:function(){return 1===this.type||2===this.type?"取消订单":3===this.type||4===this.type||5===this.type?"再次购买":void 0},isOperate:function(){return 6!==this.type}}})}),$.init()}),require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(e,t){"use strict";e.config.delimiters=["${","}"],e.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-cart",function(a,o,n){var i=new e({el:"#page-cart",data:{allChecked:!0,addCartNum1:1,addCartNum2:1,addCartNum3:1,addCartNum4:1,addCartNum5:1}});i.$watch("addCartNum1",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){cartVm.addCartNum1=o})))}),i.$watch("addCartNum2",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){cartVm.addCartNum2=o})))}),i.$watch("addCartNum3",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){cartVm.addCartNum3=o})))}),i.$watch("addCartNum4",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){cartVm.addCartNum4=o})))}),i.$watch("addCartNum5",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){cartVm.addCartNum5=o})))}),$(".my-list-cart input[type=checkbox]").prop("checked",!0),$(n).on("click",".my-nav-bar .label-checkbox",function(){i.allChecked?$(".my-list-cart input[type=checkbox]").prop("checked",!1):$(".my-list-cart input[type=checkbox]").prop("checked",!0)}),$(n).on("click",".my-list-cart .label-checkbox",function(){$(this).is(":checked")||(i.allChecked=!1)})}),$.init()}),require.config({baseUrl:"./js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(e,t){"use strict";e.config.delimiters=["${","}"],e.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-index",function(t,a,o){var n=new e({el:"#page-index",data:{search:"",hour:"02",min:"00",sec:"00"}});$(o).on("click",".icon-clear",function(){n.search=""}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-login",function(a,o,n){function i(e){return c.phone?c.password?t.checkMobile(c.phone)?void(c.isDisable||(ajaxPost("/",{username:c.phone,password:c.password},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href=t.redirect}),$.showPreloader("登录中"))):void $.toast("请输入正确的手机号",1e3):void $.toast("请输入密码",1e3):void $.toast("请输入手机号",1e3)}var c=new e({el:"#page-login",data:{phone:"",password:""},computed:{isDisable:function(){return 0===this.phone.length||0===this.password.length}},methods:{login:i}});$(window).resize(function(){$(".content").scrollTop($(window).height())})}),$(document).on("pageInit","#page-register",function(a,o,n){function i(e){if(!s.isSendCaptcha){if(!s.phone)return void $.toast("手机号不能为空",1e3);if(!t.checkMobile(s.phone))return void $.toast("请输入正确的手机号",1e3);ajaxPost("/get-captcha",{phone:s.phone,type:1},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var a=60;s.captchaTip=a+"秒",s.isSendCaptcha=!0,s.isDisable=!1,s.captchaMsg="如果您未收到短信，请在60秒后再次获取";var o=setInterval(function(){a--,a>9?s.captchaTip=a+"秒":s.captchaTip="0"+a+"秒",0===a&&(s.captchaTip="获取验证码",s.isSendCaptcha=!1,s.captchaMsg="",clearInterval(o))},1e3)}}),$.showPreloader("发送中")}}function c(e){if(s.isSendCaptcha){if(!s.phone)return void $.toast("手机号不能为空",1e3);if(!s.captcha)return void $.toast("验证码不能为空",1e3);if(!s.password)return void $.toast("密码不能为空",1e3);if(s.password!=s.rePassword)return void $.toast("密码输入不一致",1e3);if(!t.checkMobile(s.phone))return void $.toast("请输入正确的手机号",1e3);ajaxPost("/register",{phone:s.phone,password:s.password,captcha:s.captcha},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href=t.redirect}),$.showPreloader("注册中")}}var s=new e({el:"#page-register",data:{captchaTip:"获取验证码",isSendCaptcha:!1,isDisable:!0,captchaMsg:"",captcha:"",password:"",rePassword:"",phone:""},methods:{sendCaptcha:i,submitReg:c}})}),$(document).on("pageInit","#page-register-complete",function(a,o,n){function i(e){return c.phone&&!t.checkMobile(c.phone)?void $.toast("请输入正确的手机号",1e3):(ajaxPost("/register-complete",{phone:c.phone,storeName:c.storeName,receiver:c.receiver,pcdDes:c.pcdDes,address:c.address},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href=t.redirect}),void $.showPreloader("请稍等"))}var c=new e({el:"#page-register-complete",data:{phone:"",storeName:"",receiver:"",pcdDes:"浙江省 嘉兴市 南湖区",address:""},methods:{submitInfo:i}});$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button class="button button-link pull-right close-picker">确定</button>        <h1 class="title">选择收货地址</h1></header>'})}),$(document).on("pageInit","#page-rest-password",function(a,o,n){function i(e){if(!s.isSendCaptcha){if(!s.phone)return void $.toast("手机号不能为空",1e3);if(!t.checkMobile(s.phone))return void $.toast("请输入正确的手机号",1e3);ajaxPost("/get-captcha",{phone:s.phone,type:1},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var a=60;s.captchaTip=a+"秒",s.isSendCaptcha=!0,s.isDisable=!1,s.captchaMsg="如果您未收到短信，请在60秒后再次获取";var o=setInterval(function(){a--,a>9?s.captchaTip=a+"秒":s.captchaTip="0"+a+"秒",0===a&&(s.captchaTip="获取验证码",s.isSendCaptcha=!1,s.captchaMsg="",clearInterval(o))},1e3)}}),$.showPreloader("发送中")}}function c(e){if(s.isSendCaptcha){if(!s.phone)return void $.toast("手机号不能为空",1e3);if(!t.checkMobile(s.phone))return void $.toast("请输入正确的手机号",1e3);if(!s.captcha)return void $.toast("验证码不能为空");if(!s.password)return void $.toast("密码不能为空");if(s.password!=s.rePassword)return void $.toast("密码输入不一致");ajaxPost("/rest-password",{phone:s.phone,password:s.password,captcha:s.captcha},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):($.toast("密码重置成功, 请重新登录",1e3),location.href=t.redirect)}),$.showPreloader("请稍等")}}var s=new e({el:"#page-rest-password",data:{captchaTip:"获取验证码",isSendCaptcha:!1,isDisable:!0,captchaMsg:"",captcha:"",password:"",rePassword:"",phone:""},methods:{sendCaptcha:i,restPW:c}})}),$.init()}),require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(e,t){"use strict";e.config.delimiters=["${","}"],e.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-product-class",function(t,a,o){var n=new e({el:"#page-product-class",data:{categories:[],search:""}});ajaxPost("/product/class",{},function(e,t){e?$.toast(t.msg,1e3):n.categories=t.category.slice()}),$(o).on("click",".icon-clear",function(){n.search=""})}),$(document).on("pageInit","#page-product-detail",function(a,o,n){var i=new e({el:"#page-product-detail",data:{isLike:!1,cartNum:3},computed:{liked:function(){return this.isLike?"已收藏":"收藏"}}});$(n).on("click",".like",function(){$(this).toggleClass("icon-like"),$(this).toggleClass("icon-likeactive"),i.isLike=!i.isLike}),$(n).on("click",".my-back-top",function(){$(".content").scrollTop(0)});var c=$.photoBrowser({photos:["../images/demo/home-tuijian-1.jpg","../images/demo/home-tuijian-2.jpg","../images/demo/home-tuijian-3.jpg"],type:"popup"});$(n).on("click",".pb-popup",function(){c.open()});var s=new e({el:"#popup-cart",data:{addCartNum:1}});s.$watch("addCartNum",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){s.addCartNum=o})))}),$(document).on("click",".my-a-cart.close-popup",function(e){return""===s.addCartNum?(s.addCartNum=1,$.toast("请输入正确的购买数量",1e3),void e.preventDefault()):(i.cartNum+=parseInt(s.addCartNum),void(s.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){s.addCartNum=1}),$(document).on("click",".em-op-d",function(){s.addCartNum>1&&s.addCartNum--}),$(document).on("click",".em-op-a",function(){s.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on")}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-product-group-detail",function(a,o,n){var i=new e({el:"#page-product-group-detail",data:{isLike:!1,cartNum:3},computed:{liked:function(){return this.isLike?"已收藏":"收藏"}}});$(n).on("click",".like",function(){$(this).toggleClass("icon-like"),$(this).toggleClass("icon-likeactive"),i.isLike=!i.isLike}),$(n).on("click",".my-back-top",function(){$(".content").scrollTop(0)});var c=new e({el:"#popup-cart",data:{addCartNum:1}});c.$watch("addCartNum",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){c.addCartNum=o})))}),$(document).on("click",".my-a-cart.close-popup",function(){return""===c.addCartNum?(c.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(i.cartNum+=parseInt(c.addCartNum),void(c.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){c.addCartNum=1}),$(document).on("click",".em-op-d",function(){c.addCartNum>1&&c.addCartNum--}),$(document).on("click",".em-op-a",function(){c.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on")}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-product-list",function(a,o,n){var i=0;"/product/sales"===window.location.pathname?i=1:"/product/new"===window.location.pathname?i=2:"/product/group"===window.location.pathname?i=3:"/product/recommend"===window.location.pathname&&(i=4);var c=new e({el:"#page-product-list",data:{search:"",cartNum:30}});$(n).on("click",".icon-clear",function(){c.search=""});var s=new e({el:"#popup-cart",data:{addCartNum:1}});s.$watch("addCartNum",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){s.addCartNum=o})))}),$(document).on("click",".my-a-cart.close-popup",function(){return""===s.addCartNum?(s.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(c.cartNum+=parseInt(s.addCartNum),void(s.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){s.addCartNum=1}),$(document).on("click",".em-op-d",function(){s.addCartNum>1&&s.addCartNum--}),$(document).on("click",".em-op-a",function(){s.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on")})}),$(document).on("pageInit","#page-product-flash-deal-list",function(t,a,o){var n=new e({el:"#page-product-flash-deal-list",data:{search:""}});$(o).on("click",".icon-clear",function(){n.search=""})}),$.init()}),require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(e,t){"use strict";e.config.delimiters=["${","}"],e.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-my",function(t,a,o){var n=new e({el:"#page-my",data:{storeName:""}});getStoreName(function(e,t){e?$.toast(data.msg,1e3):n.storeName=t})}),$(document).on("pageInit","#page-my-account",function(t,a,o){var n=new e({el:"#page-my-account",data:{storeName:""}});getStoreName(function(e,t){e?$.toast(data.msg,1e3):n.storeName=t}),$(o).on("click","#linkName",function(){location.href="/users/change-shop-name"}),$(o).on("click","#linkAddress",function(){location.href="/users/my-address"}),$(o).on("click","#linkPassword",function(){location.href="/users/change-password"})}),$(document).on("pageInit","#page-change-shop-name",function(t,a,o){function n(e){ajaxPost("/users/setStoreName",{storeName:i.storeName},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href="/users/account"}),$.showPreloader("保存中")}var i=new e({el:"#page-change-shop-name",data:{storeName:""},methods:{setStoreName:n}});getStoreName(function(e,t){e?$.toast(data.msg,1e3):i.storeName=t})}),$(document).on("pageInit","#page-change-password",function(t,a,o){function n(e){if(!i.isDisable){if(i.newPW!=i.rePW)return void $.toast("密码输入不一致");ajaxPost("/users/change-password",{password:i.newPW},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):($.toast("新密码设置成功！",1e3),location.href="/users/account")}),$.showPreloader("保存中")}}var i=new e({el:"#page-change-password",data:{oldPW:"",newPW:"",rePW:""},computed:{isDisable:function(){return 0===this.oldPW.length||0===this.newPW.length||0===this.rePW.length}},method:{changePW:n}})}),$(document).on("pageInit","#page-my-buy-report",function(a,o,n){var i=t.dateFormat(new Date,"yyyy-MM-dd"),c=new e({el:"#page-my-buy-report",data:{start:i,end:i}});$(n).on("click",".button",function(){$.router.load("/users/buy-report-result")}),$("#my-start-time").calendar({value:[c.start]}),$("#my-end-time").calendar({value:[c.end]})}),$(document).on("pageInit","#page-my-buy-report-result",function(t,a,o){new e({el:"#page-my-buy-report-result",data:{}})}),$(document).on("pageInit","#page-my-fav",function(a,o,n){var i=new e({el:"#page-my-fav",data:{search:"",cartNum:30}});$(n).on("click",".icon-clear",function(){i.search=""}),$(n).on("click",".like",function(){$(this).toggleClass("icon-like"),$(this).toggleClass("icon-likeactive"),$(this).hasClass("icon-like")?$(this).children("span").text("收藏"):$(this).children("span").text("已收藏")}),$(n).on("click",".icon-clear",function(){i.search=""}),$(n).on("click",".button",function(){$.popup(".popup-cart")});var c=new e({el:"#popup-cart",data:{addCartNum:1}});c.$watch("addCartNum",function(a,o){""!==a&&(t.isPositiveNum(a)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){c.addCartNum=o})))}),$(document).on("click",".my-a-cart.close-popup",function(){return""===c.addCartNum?(c.addCartNum=1,$.toast("请输入正确的购买数量",1e3),void a.preventDefault()):(i.cartNum+=parseInt(c.addCartNum),void(c.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){c.addCartNum=1}),$(document).on("click",".em-op-d",function(){c.addCartNum>1&&c.addCartNum--}),$(document).on("click",".em-op-a",function(){c.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on")})}),$(document).on("pageInit","#page-my-message",function(t,a,o){new e({el:"#page-my-message",data:{}});$(o).on("click",".open-message-modal",function(){$.modal({title:'消息标题消息标题消息标题消息标题消息标题消息标题消息标题<span class="my-message-time">今天 09:45</span>',text:"<p>又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！<p>",extraClass:"my-dialog",buttons:[{text:'<a href="#" class="icon icon-close my-black-text"></a>'}]})})}),$(document).on("pageInit","#page-my-address",function(t,a,o){function n(e,t){$.confirm("确定删除该地址吗?",function(){ajaxPost("/address/del-receiver",{receiverId:c.receivers[e].receiverId},function(t,a){t?$.toast(t,1e3):c.receivers.splice(e,1)})},function(){})}function i(t){if(t>=0){$("title").text("修改地址-好好卖");var a=c.receivers[t];s=new e({el:"#popup-adr",data:{index:t,receiverId:a.receiverId,phone:a.phone,receiver:a.receiver,pcdDes:a.pcdDes,address:a.address,isDefault:a.isDefault}})}else s=new e({el:"#popup-adr",data:{index:-1,receiverId:0,phone:"",receiver:"",pcdDes:"浙江省 嘉兴市 南湖区",address:"",isDefault:!1}}),$("title").text("新增地址-好好卖");$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button class="button button-link pull-right close-picker">确定</button>        <h1 class="title">选择收货地址</h1></header>'}),$.popup(".popup-adr")}var c=new e({el:"#page-my-address",data:{receivers:[],defaultIdx:null,OPAdr:null},methods:{deleteAdr:n,addOrEditAdr:i}}),s=void 0;ajaxPost("/address/get-all-receiver",{},function(e,t){if(e)$.toast(e,1e3);else for(var a=t.receiver,o=a.length,n=0;o>n;n++){var i={};i.receiverId=a[n].SysNo,i.phone=a[n].ReceiverPhone,i.receiver=a[n].ReceiverName,i.pcdDes=a[n].Province+" "+a[n].City+" "+a[n].District,i.address=a[n].Address,i.isDefault=a[n].IsDefault,c.receivers.push(i)}}),$(document).on("click",".close-popup",function(e){e.preventDefault();var t="/address/modify-receiver";0===s.receiverId&&(t="/address/add-receiver"),ajaxPost(t,{receiverId:s.receiverId,phone:s.phone,receiver:s.receiver,pcdDes:s.pcdDes,address:s.address,isDefault:s.isDefault},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var a=void 0;-1===s.index?(a={},a.receiverId=t.receiverId,a.phone=s.phone,a.receiver=s.receiver,a.pcdDes=s.pcdDes,a.address=s.address,a.isDefault=s.isDefault,c.receivers.push(a)):(a=c.receivers[s.index],a.phone=s.phone,a.receiver=s.receiver,a.pcdDes=s.pcdDes,a.address=s.address,a.isDefault=s.isDefault),s.$destroy()}}),$.showPreloader("请稍等"),$("title").text("地址管理-好好卖")}),$(o).on("change",'[name="single-radio"]',function(){ajaxPost("/address/set-default-receiver",{receiverId:c.receivers[c.defaultIdx].receiverId},function(e,t){if(e)$.toast(e,1e3);else{for(var a=c.receivers.length,o=0;a>o;o++)o===c.defaultIdx?c.receivers[o].isDefault=!0:c.receivers[o].isDefault=!1;$.hidePreloader()}}),$.showPreloader("保存中")})}),$.init()});