!function(){function e(e,r,i){$.ajax({type:"POST",url:e,data:r,timeout:15e3,success:function(e,r,t){e.status?i(null,e):i(e.msg,null)},error:function(r,t,s){console.error(e+" error: "+t+"##"+s),i("服务异常",null)}})}require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(r,i){"use strict";r.config.delimiters=["${","}"],r.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-address-select",function(t,s,a){var c=i.getSearch(location),d=0;c.id&&(d=parseInt(c.id));var o=new r({el:"#page-address-select",data:{receivers:[]}});e("/address/get-all-receiver",{},function(e,r){if(e)$.toast(e,1e3);else for(var i=r.receiver,t=i.length,s=0;t>s;s++){var a={};a.receiverId=i[s].SysNo,a.phone=i[s].ReceiverMobile,a.receiver=i[s].ReceiverName,a.pcdDes=i[s].Province+" "+i[s].City+" "+i[s].District,a.address=i[s].Address,a.isDefault=i[s].IsDefault,a.isSelected=a.receiverId===d,o.receivers.push(a)}})}),$(document).on("pageInit","#page-address-edit",function(t,s,a){var c=void 0;if("/address/modify"===location.pathname){var d=i.getSearch(location);if(!d.id)return void(location.pathname="/");var o=parseInt(d.id);e("/address/get-all-receiver",{receiverId:o},function(e,i){$.hidePreloader(),e?$.toast(e,1e3):(c=new r({el:"#page-address-edit",data:{receiverId:i.receiver.SysNo,phone:i.receiver.ReceiverMobile,receiver:i.receiver.ReceiverName,pcdDes:i.receiver.Province+" "+i.receiver.City+" "+i.receiver.District,address:i.receiver.Address,isDefault:i.receiver.IsDefault}}),$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button class="button button-link pull-right close-picker">              确定</button><h1 class="title">选择收货地址</h1></header>'}))}),$.showPreloader("请稍等")}else c=new r({el:"#page-address-edit",data:{receiverId:0,phone:"",receiver:"",pcdDes:"浙江省 嘉兴市 南湖区",address:"",isDefault:!1}}),$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button class="button button-link pull-right close-picker">          确定</button><h1 class="title">选择收货地址</h1></header>'});$(a).on("click",".button",function(r){r.preventDefault();var i="/address/modify-receiver";0===c.receiverId&&(i="/address/add-receiver"),e(i,{receiverId:c.receiverId,phone:c.phone,receiver:c.receiver,pcdDes:c.pcdDes,address:c.address,isDefault:c.isDefault},function(e,r){$.hidePreloader(),e?$.toast(e,1e3):window.history.back()}),$.showPreloader("保存中")})}),$.init()})}();