!function(){function e(e,t,r){$.ajax({type:"POST",url:e,data:t,timeout:15e3,success:function(e,t,o){e.status?r(null,e):r(e.msg,null)},error:function(t,o,i){console.error(e+" error: "+o+"##"+i),r("服务异常",null)}})}require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(t,r){"use strict";t.config.delimiters=["${","}"],t.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-book-confirm",function(r,o,i){var c=new t({el:"#page-book-confirm",data:{payment:1,receiver:null,cartsAry:[],countPrice:0}});e("/address/get-all-receiver",{},function(e,t){if(e)$.toast(e,1e3);else{for(var r=t.receiver,o=r.length,i=0;o>i;i++)if(r[i].IsDefault){c.receiver={},c.receiver.receiverId=r[i].SysNo,c.receiver.phone=r[i].ReceiverPhone,c.receiver.receiver=r[i].ReceiverName,c.receiver.pcdDes=r[i].Province+" "+r[i].City+" "+r[i].District,c.receiver.address=r[i].Address;break}null===c.receiver&&o>0&&(c.receiver={},c.receiver.receiverId=r[0].SysNo,c.receiver.phone=r[0].ReceiverPhone,c.receiver.receiver=r[0].ReceiverName,c.receiver.pcdDes=r[0].Province+" "+r[0].City+" "+r[0].District,c.receiver.address=r[0].Address)}}),e("/cart/cart-info",{},function(e,t){if(e)$.toast(e,1e3);else{for(var r=t.cart,o=r.length,i=null,s={},n=0;o>n;n++){i=r[n];var a={};void 0===s[i.ProductSysNo]?(s[i.ProductSysNo]={},s[i.ProductSysNo].name=i.Name,s[i.ProductSysNo].productId=i.ProductSysNo,s[i.ProductSysNo].image=i.Images.length>0?i.Images[0].ImgUrl:"",s[i.ProductSysNo].skus=[],s[i.ProductSysNo].checked=!0,s[i.ProductSysNo].stock=i.Stock,a.cartId=i.SysId,a.skuId=i.SkuSysNo,a.size=i.SizeName,a.qty=i.Qty,a.price=i.Price,c.countPrice+=a.price*a.qty,s[i.ProductSysNo].skus.push(a)):(a.cartId=i.SysId,a.skuId=i.SkuSysNo,a.size=i.SizeName,a.qty=i.Qty,a.price=i.Price,c.countPrice+=a.price*a.qty,s[i.ProductSysNo].skus.push(a))}for(var u in s)s.hasOwnProperty(u)&&c.cartsAry.push(s[u])}}),$(i).on("click","#submitBook",function(){return 1===c.payment?void(location.href="/book/pay-way"):2===c.payment?void(location.href="/book/complete"):void 0})}),$(document).on("pageInit","#page-book-complete",function(e,r,o){new t({el:"#page-book-complete",data:{}})}),$(document).on("pageInit","#page-book-pay-way",function(e,r,o){new t({el:"#page-book-pay-way",data:{}})}),$(document).on("pageInit","#page-book-detail",function(e,o,i){var c=r.getSearch(location);new t({el:"#page-book-detail",data:{type:parseInt(c.status)},computed:{bookStatus:function(){return 1===this.type?"待付款":2===this.type?"待审核":3===this.type?"已完成":4===this.type?"已取消":5===this.type?"已发货":6===this.type?"待发货":void 0},isNeedPay:function(){return 1===this.type},operateName:function(){return 1===this.type||2===this.type?"取消订单":3===this.type||4===this.type||5===this.type?"再次购买":void 0},isOperate:function(){return 6!==this.type}}})}),$.init()})}();