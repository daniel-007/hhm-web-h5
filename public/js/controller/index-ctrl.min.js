!function(){function e(e,t,a){$.ajax({type:"POST",url:e,data:t,timeout:15e3,success:function(e,t,o){e.status?a(null,e):a(e.msg,null)},error:function(t,o,s){console.error(e+" error: "+o+"##"+s),a("服务异常",null)}})}require.config({baseUrl:"./js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(t,a){"use strict";t.config.delimiters=["${","}"],t.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-index",function(a,o,s){var i=new t({el:"#page-index",data:{search:"",banners:[],newsImg:"",salesImg:"",groupImg:"",secKillImg:"",recommends:[]}});e("/get-home",{},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var a=t.home;i.banners=a.banner.slice(),i.newsImg=a.news.img,i.salesImg=a.sales.img,i.groupImg=a.group.img,i.secKillImg=a.secKill.img,i.recommends=a.recommend.slice(),i.$nextTick(function(){$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})})}}),$.showPreloader("请稍等..."),$(s).on("click",".icon-clear",function(){i.search=""})}),$(document).on("pageInit","#page-login",function(o,s,i){function n(t){return r.phone?r.password?a.checkMobile(r.phone)?void(r.isDisable||(e("/",{username:r.phone,password:r.password},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href=t.redirect}),$.showPreloader("登录中"))):void $.toast("请输入正确的手机号",1e3):void $.toast("请输入密码",1e3):void $.toast("请输入手机号",1e3)}var r=new t({el:"#page-login",data:{phone:"",password:""},computed:{isDisable:function(){return 0===this.phone.length||0===this.password.length}},methods:{login:n}});$(window).resize(function(){$(".content").scrollTop($(window).height())})}),$(document).on("pageInit","#page-register",function(o,s,i){function n(t){if(!c.isSendCaptcha){if(!c.phone)return void $.toast("手机号不能为空",1e3);if(!a.checkMobile(c.phone))return void $.toast("请输入正确的手机号",1e3);e("/get-captcha",{phone:c.phone,type:1},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var a=60;c.captchaTip=a+"秒",c.isSendCaptcha=!0,c.isDisable=!1,c.captchaMsg="如果您未收到短信，请在60秒后再次获取";var o=setInterval(function(){a--,a>9?c.captchaTip=a+"秒":c.captchaTip="0"+a+"秒",0===a&&(c.captchaTip="获取验证码",c.isSendCaptcha=!1,c.captchaMsg="",clearInterval(o))},1e3)}}),$.showPreloader("发送中")}}function r(t){if(c.isSendCaptcha){if(!c.phone)return void $.toast("手机号不能为空",1e3);if(!c.captcha)return void $.toast("验证码不能为空",1e3);if(!c.password)return void $.toast("密码不能为空",1e3);if(c.password!=c.rePassword)return void $.toast("密码输入不一致",1e3);if(!a.checkMobile(c.phone))return void $.toast("请输入正确的手机号",1e3);e("/register",{phone:c.phone,password:c.password,captcha:c.captcha},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href=t.redirect}),$.showPreloader("注册中")}}var c=new t({el:"#page-register",data:{captchaTip:"获取验证码",isSendCaptcha:!1,isDisable:!0,captchaMsg:"",captcha:"",password:"",rePassword:"",phone:""},methods:{sendCaptcha:n,submitReg:r}})}),$(document).on("pageInit","#page-register-complete",function(o,s,i){function n(t){return r.phone&&!a.checkMobile(r.phone)?void $.toast("请输入正确的手机号",1e3):(e("/register-complete",{phone:r.phone,storeName:r.storeName,receiver:r.receiver,pcdDes:r.pcdDes,address:r.address},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href=t.redirect}),void $.showPreloader("请稍等"))}var r=new t({el:"#page-register-complete",data:{phone:"",storeName:"",receiver:"",pcdDes:"浙江省 嘉兴市 南湖区",address:""},methods:{submitInfo:n}});$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button class="button button-link pull-right close-picker">确定</button>        <h1 class="title">选择收货地址</h1></header>'})}),$(document).on("pageInit","#page-rest-password",function(o,s,i){function n(t){if(!c.isSendCaptcha){if(!c.phone)return void $.toast("手机号不能为空",1e3);if(!a.checkMobile(c.phone))return void $.toast("请输入正确的手机号",1e3);e("/get-captcha",{phone:c.phone,type:1},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var a=60;c.captchaTip=a+"秒",c.isSendCaptcha=!0,c.isDisable=!1,c.captchaMsg="如果您未收到短信，请在60秒后再次获取";var o=setInterval(function(){a--,a>9?c.captchaTip=a+"秒":c.captchaTip="0"+a+"秒",0===a&&(c.captchaTip="获取验证码",c.isSendCaptcha=!1,c.captchaMsg="",clearInterval(o))},1e3)}}),$.showPreloader("发送中")}}function r(t){if(c.isSendCaptcha){if(!c.phone)return void $.toast("手机号不能为空",1e3);if(!a.checkMobile(c.phone))return void $.toast("请输入正确的手机号",1e3);if(!c.captcha)return void $.toast("验证码不能为空");if(!c.password)return void $.toast("密码不能为空");if(c.password!=c.rePassword)return void $.toast("密码输入不一致");e("/rest-password",{phone:c.phone,password:c.password,captcha:c.captcha},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):($.toast("密码重置成功, 请重新登录",1e3),location.href=t.redirect)}),$.showPreloader("请稍等")}}var c=new t({el:"#page-rest-password",data:{captchaTip:"获取验证码",isSendCaptcha:!1,isDisable:!0,captchaMsg:"",captcha:"",password:"",rePassword:"",phone:""},methods:{sendCaptcha:n,restPW:r}})}),$.init()})}();