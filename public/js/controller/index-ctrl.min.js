!function(){function e(e,t,o){$.ajax({type:"POST",url:e,data:t,timeout:15e3,success:function(e,t,a){e.status?o(null,e):o(e.msg,null)},error:function(t,a,s){console.error(e+" error: "+a+"##"+s),o("服务异常",null)}})}require.config({baseUrl:"./js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(t,o){"use strict";t.config.delimiters=["${","}"],t.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-index",function(o,a,s){var i=new t({el:"#page-index",data:{search:"",banners:[],newsImg:"",salesImg:"",groupImg:"",secKillImg:"",recommends:[],message:0}});e("/get-home",{},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var o=t.home;i.banners=o.banner.slice(),i.newsImg=o.news.img,i.salesImg=o.sales.img,i.groupImg=o.group.img,i.secKillImg=o.secKill.img,i.recommends=o.recommend.slice(),i.$nextTick(function(){$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})})}}),$.showPreloader("请稍等..."),e("/users/get-notice-count",{},function(e,t){e||(i.message=t.count)}),$(s).on("click",".icon-clear",function(){i.search=""})}),$(document).on("pageInit","#page-login",function(a,s,i){function n(t){return r.phone?r.password?o.checkMobile(r.phone)?void(r.isDisable||(e("/",{username:r.phone,password:r.password},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href=t.redirect}),$.showPreloader("登录中"))):void $.toast("请输入正确的手机号",1e3):void $.toast("请输入密码",1e3):void $.toast("请输入手机号",1e3)}var r=new t({el:"#page-login",data:{phone:"",password:""},computed:{isDisable:function(){return 0===this.phone.length||0===this.password.length}},methods:{login:n}});$(window).resize(function(){$(".content").scrollTop($(window).height())})}),$(document).on("pageInit","#page-register",function(a,s,i){function n(t){return c.isSendCaptcha?void 0:c.phone?o.checkMobile(c.phone)?void e("/is-registered",{phone:c.phone},function(t,o){t?$.toast(t,1e3):o.isRegistered?$.toast("该手机号已被注册",1e3):(e("/get-captcha",{phone:c.phone,type:1},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var o=60;c.captchaTip=o+"秒",c.isSendCaptcha=!0,c.isDisable=!1,c.captchaMsg="如果您未收到短信，请在60秒后再次获取";var a=setInterval(function(){o--,o>9?c.captchaTip=o+"秒":c.captchaTip="0"+o+"秒",0===o&&(c.captchaTip="获取验证码",c.isSendCaptcha=!1,c.captchaMsg="",clearInterval(a))},1e3)}}),$.showPreloader("发送中"))}):void $.toast("请输入正确的手机号",1e3):void $.toast("手机号不能为空",1e3)}function r(t){if(c.isSendCaptcha){if(!c.phone)return void $.toast("手机号不能为空",1e3);if(!c.captcha)return void $.toast("验证码不能为空",1e3);if(!c.password)return void $.toast("密码不能为空",1e3);if(c.password!=c.rePassword)return void $.toast("密码输入不一致",1e3);if(!o.checkMobile(c.phone))return void $.toast("请输入正确的手机号",1e3);e("/register",{phone:c.phone,password:c.password,captcha:c.captcha},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href=t.redirect}),$.showPreloader("注册中")}}var c=new t({el:"#page-register",data:{captchaTip:"获取验证码",isSendCaptcha:!1,isDisable:!0,captchaMsg:"",captcha:"",password:"",rePassword:"",phone:""},methods:{sendCaptcha:n,submitReg:r}})}),$(document).on("pageInit","#page-register-complete",function(a,s,i){function n(t){return r.phone&&!o.checkMobile(r.phone)?void $.toast("请输入正确的手机号",1e3):(e("/register-complete",{phone:r.phone,storeName:r.storeName,receiver:r.receiver,pcdDes:r.pcdDes,address:r.address},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{$.toast("恭喜您, 注册成功！",1e3);var o=t.redirect;setTimeout(function(){location.href=o},1e3)}}),void $.showPreloader("请稍等"))}var r=new t({el:"#page-register-complete",data:{phone:"",storeName:"",receiver:"",pcdDes:"浙江省 嘉兴市 南湖区",address:""},methods:{submitInfo:n}});$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button class="button button-link pull-right close-picker">确定</button>        <h1 class="title">选择收货地址</h1></header>'})}),$(document).on("pageInit","#page-rest-password",function(a,s,i){function n(t){if(!c.isSendCaptcha){if(!c.phone)return void $.toast("手机号不能为空",1e3);if(!o.checkMobile(c.phone))return void $.toast("请输入正确的手机号",1e3);e("/get-captcha",{phone:c.phone,type:1},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var o=60;c.captchaTip=o+"秒",c.isSendCaptcha=!0,c.isDisable=!1,c.captchaMsg="如果您未收到短信，请在60秒后再次获取";var a=setInterval(function(){o--,o>9?c.captchaTip=o+"秒":c.captchaTip="0"+o+"秒",0===o&&(c.captchaTip="获取验证码",c.isSendCaptcha=!1,c.captchaMsg="",clearInterval(a))},1e3)}}),$.showPreloader("发送中")}}function r(t){if(c.isSendCaptcha){if(!c.phone)return void $.toast("手机号不能为空",1e3);if(!o.checkMobile(c.phone))return void $.toast("请输入正确的手机号",1e3);if(!c.captcha)return void $.toast("验证码不能为空");if(!c.password)return void $.toast("密码不能为空");if(c.password!=c.rePassword)return void $.toast("密码输入不一致");e("/rest-password",{phone:c.phone,password:c.password,captcha:c.captcha},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):($.toast("密码重置成功, 请重新登录",1e3),location.href=t.redirect)}),$.showPreloader("请稍等")}}var c=new t({el:"#page-rest-password",data:{captchaTip:"获取验证码",isSendCaptcha:!1,isDisable:!0,captchaMsg:"",captcha:"",password:"",rePassword:"",phone:""},methods:{sendCaptcha:n,restPW:r}})}),$.init()})}();