!function(){function t(t,o,c){$.ajax({type:"POST",url:t,data:o,timeout:15e3,success:function(t,o,u){t.status?c(null,t):c(t.msg,null)},error:function(o,u,n){console.error(t+" error: "+u+"##"+n),c("服务异常",null)}})}function o(o,c,u,n){var e={};return e.url=o,e.cid=u||0,e.childId=n||0,e.pageSize=c,e.pageId=0,e.addItems=function(o){var c=this;t(this.url,{CId:e.cid,ChildCId:e.childId,pageId:this.pageId,pageSize:this.pageSize},function(t,u){t?o(t,null):(c.pageId++,o(null,u))})},e}function c(t){var o=Math.floor(t/36e5),c=Math.floor(t%864e5%36e5/6e4),u=Math.floor(t%864e5%36e5%6e4/1e3);return o=o>9?o:"0"+o,c=c>9?c:"0"+c,u=u>9?u:"0"+u,o+":"+c+":"+u}require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(u,n){"use strict";u.config.delimiters=["${","}"],u.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-product-class",function(o,c,n){var e=new u({el:"#page-product-class",data:{categories:[],search:"",message:0}});t("/users/get-notice-count",{},function(t,o){t||(e.message=o.count)}),t("/product/class",{},function(t,o){t?$.toast(t,1e3):e.categories=o.category.slice()}),$(n).on("click",".icon-clear",function(){e.search=""})}),$(document).on("pageInit","#page-product-detail",function(o,c,e){function a(){$.popup(".popup-cart")}function r(){return""===l.addCartNum?(l.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:l.product.SysNo,skuId:l.curSkuId,qty:l.addCartNum},function(t,o){t?$.toast(t,1e3):d()}),l.addCartNum=1,void(l.product=null))}function d(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}var i=n.getSearch(location);if(!i.id)return void(location.pathname="/");var s=new u({el:"#page-product-detail",data:{isLike:!1,cartNum:0,product:null,style:[],skuImg:[]},computed:{liked:function(){return this.isLike?"已收藏":"收藏"}},methods:{OpenCart:a}}),l=new u({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:r}});d(),t("/product/detail",{productId:parseInt(i.id)},function(t,o){if(t)$.toast(t,1e3);else{s.product=n.clone(o.product);var c=0;l.product=s.product;var u=s.product.Skus;for(l.curSkuId=u[0].SysNo,l.curPrice=u[0].Price,l.curImg=u[0].Images[0].ImgUrl,c=0;c<u.length;c++)s.style.push(u[c].SizeName),u[c].Images.length>0&&s.skuImg.push(u[c].Images[0].ImgUrl)}}),$(e).on("click",".like",function(){t(s.isLike?"/users/del-fav":"/users/add-fav",{productId:parseInt(i.id)},function(t,o){$.hidePreloader(),t?$.toast(t,1e3):s.isLike=!s.isLike}),s.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(e).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),l.$watch("addCartNum",function(t,o){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),u.nextTick(function(){l.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){l.addCartNum=1}),$(document).on("click",".em-op-d",function(){l.addCartNum>1&&l.addCartNum--}),$(document).on("click",".em-op-a",function(){l.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=s.product.Skus[t];l.curSkuId=o.SysNo,l.curPrice=o.Price,l.curImg=o.Images[0].ImgUrl}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-secKill-product-detail",function(o,c,e){function a(){$.popup(".popup-cart")}function r(){return""===l.addCartNum?(l.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:l.product.SysNo,skuId:l.curSkuId,qty:l.addCartNum},function(t,o){t?$.toast(t,1e3):d()}),l.addCartNum=1,void(l.product=null))}function d(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}var i=n.getSearch(location);if(!i.id)return void(location.pathname="/");var s=new u({el:"#page-secKill-product-detail",data:{isLike:!1,cartNum:0,product:null,style:[],skuImg:[]},computed:{liked:function(){return this.isLike?"已收藏":"收藏"}},methods:{OpenCart:a}}),l=new u({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:r}});d(),t("/product/secKill-detail",{productId:parseInt(i.id)},function(t,o){if(t)$.toast(t,1e3);else{s.product=n.clone(o.product),l.product=s.product,l.curPrice=s.product.SeckillPrice;var c=s.product.Skus;l.curSkuId=c[0].SysNo,l.curImg=c[0].Images[0].ImgUrl;for(var u=0;u<c.length;u++)s.style.push(c[u].SizeName),c[u].Images.length>0&&s.skuImg.push(c[u].Images[0].ImgUrl)}}),$(e).on("click",".like",function(){t(s.isLike?"/users/del-fav":"/users/add-fav",{productId:parseInt(i.id)},function(t,o){$.hidePreloader(),t?$.toast(t,1e3):s.isLike=!s.isLike}),s.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(e).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),l.$watch("addCartNum",function(t,o){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),u.nextTick(function(){l.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){l.addCartNum=1}),$(document).on("click",".em-op-d",function(){l.addCartNum>1&&l.addCartNum--}),$(document).on("click",".em-op-a",function(){l.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=s.product.Skus[t];l.curSkuId=o.SysNo,l.curPrice=o.Price,l.curImg=o.Images[0].ImgUrl}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-product-group-detail",function(o,c,e){function a(){$.popup(".popup-cart")}function r(){return""===l.addCartNum?(l.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:l.product.SysNo,skuId:l.curSkuId,qty:l.addCartNum},function(t,o){t?$.toast(t,1e3):d()}),l.addCartNum=1,void(l.product=null))}function d(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}var i=n.getSearch(location);if(!i.id)return void(location.pathname="/");var s=new u({el:"#page-product-group-detail",data:{isLike:!1,cartNum:0,product:null,style:[],skuImg:[]},computed:{liked:function(){return this.isLike?"已收藏":"收藏"}},methods:{OpenCart:a}}),l=new u({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:r}});d(),t("/product/group-detail",{productId:parseInt(i.id)},function(t,o){if(t)$.toast(t,1e3);else{s.product=n.clone(o.product),l.product=s.product;var c=s.product.Skus;l.curSkuId=c[0].SysNo,l.curPrice=c[0].Price,l.curImg=c[0].Images[0].ImgUrl;for(var u=0;u<c.length;u++)s.style.push(c[u].SizeName),c[u].Images.length>0&&s.skuImg.push(c[u].Images[0].ImgUrl)}}),$(e).on("click",".like",function(){t(s.isLike?"/users/del-fav":"/users/add-fav",{productId:parseInt(i.id)},function(t,o){$.hidePreloader(),t?$.toast(t,1e3):s.isLike=!s.isLike}),s.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(e).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),l.$watch("addCartNum",function(t,o){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),u.nextTick(function(){l.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){l.addCartNum=1}),$(document).on("click",".em-op-d",function(){l.addCartNum>1&&l.addCartNum--}),$(document).on("click",".em-op-a",function(){l.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=s.product.Skus[t];l.curSkuId=o.SysNo,l.curPrice=o.Price,l.curImg=o.Images[0].ImgUrl}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-product-list",function(c,e,a){function r(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}function d(t){f.product=s.products[t],f.curSkuId=f.product.SkuList[0].SysNo,f.curPrice=f.product.SkuList[0].Price,f.curImg=f.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}function i(){return""===f.addCartNum?(f.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:f.product.SysNo,skuId:f.curSkuId,qty:f.addCartNum},function(t,o){t?$.toast(t,1e3):r()}),f.addCartNum=1,void(f.product=null))}var s=new u({el:"#page-product-list",data:{search:"",products:[],count:0,cartNum:0},methods:{OpenCart:d}}),l=void 0,p=!1;if(r(),"/product/sales"===location.pathname)l=new o("/product/sales",10),l.addItems(function(t,o){t?$.toast(t,1e3):(s.count=o.count,s.products=s.products.concat(o.products))});else if("/product/new"===location.pathname)l=new o("/product/new",10),l.addItems(function(t,o){t?$.toast(t,1e3):(s.count=o.count,s.products=s.products.concat(o.products))});else if("/product/category"===location.pathname){var m=n.getSearch(location);if(!m.CId||!m.ChildCId)return void(location.pathname="/");l=new o("/product/category",10,parseInt(m.CId),parseInt(m.ChildCId)),l.addItems(function(t,o){t?$.toast(t,1e3):(s.count=o.count,s.products=s.products.concat(o.products))})}$(a).on("infinite",".infinite-scroll-bottom",function(){p||(p=!0,setTimeout(function(){return p=!1,s.products.length>=s.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(l.addItems(function(t,o){t?$.toast(t,1e3):(s.count=o.count,s.products=s.products.concat(o.products))}),void $.refreshScroller())},1e3))});var f=new u({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:i}});$(a).on("click",".icon-clear",function(){s.search=""}),f.$watch("addCartNum",function(t,o){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),u.nextTick(function(){f.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),f.addCartNum=1,f.product=null}),$(document).on("click",".em-op-d",function(){f.addCartNum>1&&f.addCartNum--}),$(document).on("click",".em-op-a",function(){f.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=f.product.SkuList[t];f.curPrice=o.Price,f.curImg=o.Images[0].ImgUrl,f.curSkuId=o.SysNo})}),$(document).on("pageInit","#page-product-group-list",function(c,e,a){function r(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}function d(t){m.product=s.products[t],m.curSkuId=m.product.SkuList[0].SysNo,m.curPrice=m.product.SkuList[0].Price,m.curImg=m.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}function i(){return""===m.addCartNum?(m.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:m.product.SysNo,skuId:m.curSkuId,qty:m.addCartNum},function(t,o){t?$.toast(t,1e3):r()}),m.addCartNum=1,void(m.product=null))}var s=new u({el:"#page-product-group-list",data:{search:"",products:[],count:0,cartNum:0},methods:{OpenCart:d}}),l=!1;r();var p=new o("/product/group",10);p.addItems(function(t,o){t?$.toast(t,1e3):(s.count=o.count,s.products=s.products.concat(o.products))}),$(a).on("infinite",".infinite-scroll-bottom",function(){l||(l=!0,setTimeout(function(){return l=!1,s.products.length>=s.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(p.addItems(function(t,o){t?$.toast(t,1e3):(s.count=o.count,s.products=s.products.concat(o.products))}),void $.refreshScroller())},1e3))}),$(a).on("click",".icon-clear",function(){s.search=""});var m=new u({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:i}});m.$watch("addCartNum",function(t,o){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),u.nextTick(function(){m.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),m.addCartNum=1,m.product=null}),$(document).on("click",".em-op-d",function(){m.addCartNum>1&&m.addCartNum--}),$(document).on("click",".em-op-a",function(){m.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=m.product.SkuList[t];m.curPrice=o.Price,m.curImg=o.Images[0].ImgUrl,m.curSkuId=o.SysNo})}),$(document).on("pageInit","#page-recommend-list",function(c,e,a){function r(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}function d(t){f.product=s.products[t],f.curSkuId=f.product.SkuList[0].SysNo,f.curPrice=f.product.SkuList[0].Price,f.curImg=f.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}function i(){return""===f.addCartNum?(f.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:f.product.SysNo,skuId:f.curSkuId,qty:f.addCartNum},function(t,o){t?$.toast(t,1e3):r()}),f.addCartNum=1,void(f.product=null))}var s=new u({el:"#page-recommend-list",data:{search:"",products:[],count:0,cartNum:0},methods:{OpenCart:d}}),l=!1,p=n.getSearch(location);if(!p.id)return void(location.pathname="/");r();var m=new o("/product/recommend",10,parseInt(p.id));m.addItems(function(t,o){t?$.toast(t,1e3):(s.count=o.count,console.log("data:"+JSON.stringify(o)),s.products=s.products.concat(o.products))}),$(a).on("infinite",".infinite-scroll-bottom",function(){l||(l=!0,setTimeout(function(){return l=!1,s.products.length>=s.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(m.addItems(function(t,o){t?$.toast(t,1e3):(s.count=o.count,s.products=s.products.concat(o.products))}),void $.refreshScroller())},1e3))}),$(a).on("click",".icon-clear",function(){s.search=""});var f=new u({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:i}});f.$watch("addCartNum",function(t,o){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),u.nextTick(function(){f.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),f.addCartNum=1,f.product=null}),$(document).on("click",".em-op-d",function(){f.addCartNum>1&&f.addCartNum--}),$(document).on("click",".em-op-a",function(){f.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=f.product.SkuList[t];f.curPrice=o.Price,f.curImg=o.Images[0].ImgUrl,f.curSkuId=o.SysNo})}),$(document).on("pageInit","#page-product-flash-deal-list",function(t,n,e){function a(t){if(t.RemainStartTotalSeconds>0)t.RemainStartTotalSeconds-=1e3,t.remainStart=c(t.RemainStartTotalSeconds);else{t.killStatus=1;var o=new Date(t.EndTime).getTime(),u=(new Date).getTime();t.RemainEndTotalSeconds=o-u}}function r(t){t.RemainEndTotalSeconds>0?(t.RemainEndTotalSeconds-=1e3,t.remainEnd=c(t.RemainEndTotalSeconds)):t.killStatus=0}var d=new u({el:"#page-product-flash-deal-list",data:{search:"",count:0,products:[]}}),i=new o("/product/secKill",10);i.addItems(function(t,o){if(t)$.toast(t,1e3);else{d.count=o.count;for(var u=o.products,n=u.length,e=null,a=0;n>a;a++)e=u[a],e.RemainStartTotalSeconds=1e3*parseInt(e.RemainStartTotalSeconds),e.RemainEndTotalSeconds=1e3*parseInt(e.RemainEndTotalSeconds),e.RemainEndTotalSeconds>0?(e.killStatus=1,e.remainEnd=c(e.RemainEndTotalSeconds)):e.RemainStartTotalSeconds>0?(e.killStatus=2,e.remainStart=c(e.RemainStartTotalSeconds)):e.killStatus=0;d.products=d.products.concat(o.products)}}),setInterval(function(){for(var t=d.products,o=t.length,c=null,u=0;o>u;u++)if(c=t[u],1===c.killStatus)r(c);else{if(2!==c.killStatus)continue;a(c)}},1e3),$(e).on("click",".icon-clear",function(){d.search=""})}),$.init()})}();