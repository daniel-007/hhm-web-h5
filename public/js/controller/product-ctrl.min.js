!function(){function t(t,o,c){$.ajax({type:"POST",url:t,data:o,timeout:15e3,success:function(t,o,e){-1===t.status?($.toast(t.msg,2e3),setTimeout(function(){location.href="/logout"},2e3)):t.status?c(null,t):c(t.msg,null)},error:function(o,e,r){console.error(t+" error: "+e+"##"+r),c("服务异常",null)}})}function o(o,c,e,r){var u={};return u.url=o,u.cid=e||0,u.childId=r||0,u.pageSize=c,u.pageId=0,u.addItems=function(o){var c=this;t(this.url,{CId:u.cid,ChildCId:u.childId,pageId:this.pageId,pageSize:this.pageSize},function(t,e){t?o(t,null):(c.pageId++,o(null,e))})},u}function c(o,c,e){var r={};return r.url=o,r.pageSize=c,r.pageId=0,r.key=e,r.addItems=function(o){var c=this;t(this.url,{key:r.key,pageId:this.pageId,pageSize:this.pageSize},function(t,e){t?o(t,null):(c.pageId++,o(null,e))})},r}function e(t){var o=Math.floor(t/36e5),c=Math.floor(t%864e5%36e5/6e4),e=Math.floor(t%864e5%36e5%6e4/1e3);return o=o>9?o:"0"+o,c=c>9?c:"0"+c,e=e>9?e:"0"+e,o+":"+c+":"+e}require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils.min"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(r,u){"use strict";r.config.delimiters=["${","}"],r.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-product-class",function(o,c,e){function u(){location.href="/product/search?key="+encodeURI(encodeURI(n.searchWord))}var n=new r({el:"#page-product-class",data:{categories:[],searchWord:"",message:0},methods:{search:u}});t("/users/get-notice-count",{},function(t,o){t||(n.message=o.count)}),t("/product/class",{},function(t,o){t?$.toast(t,1e3):n.categories=o.category.slice()}),$(e).on("click",".icon-clear",function(){n.searchWord=""})}),$(document).on("pageInit","#page-product-detail",function(o,c,e){function n(){$.popup(".popup-cart")}function a(){return""===l.addCartNum?(l.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:l.product.SysNo,skuId:l.curSkuId,qty:l.addCartNum},function(t,o){t?$.toast(t,1e3):d()}),void(l.addCartNum=1))}function d(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}var i=u.getSearch(location);if(!i.id)return void(location.href="/");var s=new r({el:"#page-product-detail",data:{cartNum:0,product:null,style:[],skuImg:[""],canSale:!1,swiper:null},computed:{liked:function(){return this.product.isLike?"已收藏":"收藏"}},methods:{OpenCart:n}}),l=new r({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:a}});d(),t("/product/detail",{productId:parseInt(i.id)},function(t,o){if($.hidePreloader(),t)$.toast(t,1e3);else{s.product=u.clone(o.product);var c=0;s.skuImg.splice(0,s.skuImg.length);var e=s.product.Skus;for(c=0;c<e.length;c++)s.style.push(e[c].SizeName),e[c].Images.length>0&&s.skuImg.push(e[c].Images[0].ImgUrl);s.product.Skus=s.product.Skus.filter(function(t){return t.IsOnSale}),l.product=s.product,e=l.product.Skus,e.length?(s.canSale=!0,l.curSkuId=e[0].SysNo,l.curPrice=e[0].Price,l.curImg=e[0].Images[0].ImgUrl):s.canSale=!1,r.nextTick(function(){s.swiper=new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,spaceBetween:10,centeredSlides:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}}),$.showPreloader("请稍等"),$(e).on("click",".like",function(){t(s.product.isLike?"/users/del-fav":"/users/add-fav",{productId:parseInt(i.id)},function(t,o){$.hidePreloader(),t?$.toast(t,1e3):s.product.isLike=!s.product.isLike}),s.product.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(e).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),l.$watch("addCartNum",function(t,o){""!==t&&(u.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),r.nextTick(function(){l.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){l.addCartNum=1}),$(document).on("click",".em-op-d",function(){l.addCartNum>1&&l.addCartNum--}),$(document).on("click",".em-op-a",function(){l.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=s.product.Skus[t];l.curSkuId=o.SysNo,l.curPrice=o.Price,l.curImg=o.Images[0].ImgUrl})}),$(document).on("pageInit","#page-secKill-product-detail",function(o,c,e){function n(){$.popup(".popup-cart")}function a(){return""===l.addCartNum?(l.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:l.product.SysNo,skuId:l.curSkuId,qty:l.addCartNum},function(t,o){t?$.toast(t,1e3):d()}),void(l.addCartNum=1))}function d(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}var i=u.getSearch(location);if(!i.id)return void(location.href="/");var s=new r({el:"#page-secKill-product-detail",data:{cartNum:0,product:null,isGroup:!1,group:[],style:[],skuImg:[""],swiper:null},computed:{liked:function(){return this.product.isLike?"已收藏":"收藏"}},methods:{OpenCart:n}}),l=new r({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0,total:0,limit:0},methods:{addToCart:a}});d(),t("/product/secKill-detail",{productId:parseInt(i.id)},function(t,o){if($.hidePreloader(),t)$.toast(t,1e3);else{s.product=u.clone(o.product),l.product=s.product,l.curPrice=s.product.SeckillPrice,l.total=s.product.TotalCount,l.limit=s.product.LimitBuyCount;var c=s.product.Skus;l.curSkuId=c[0].SysNo,l.curImg=c[0].Images[0].ImgUrl,s.skuImg.splice(0,s.skuImg.length);for(var e=0;e<c.length;e++)s.isGroup=c[e].IsCombination,s.group=s.group.concat(c[e].ComSku),s.style.push(c[e].SizeName),c[e].Images.length>0&&s.skuImg.push(c[e].Images[0].ImgUrl);r.nextTick(function(){s.swiper=new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,spaceBetween:10,centeredSlides:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}}),$.showPreloader("请稍等"),$(e).on("click",".like",function(){t(s.product.isLike?"/users/del-fav":"/users/add-fav",{productId:s.product.SysNo},function(t,o){$.hidePreloader(),t?$.toast(t,1e3):s.product.isLike=!s.product.isLike}),s.product.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(e).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),l.$watch("addCartNum",function(t,o){return""!==t?u.isPositiveNum(t)?t>l.total?($.toast("超出库存数量！",1e3),void r.nextTick(function(){l.addCartNum=o})):t>l.limit?($.toast("超出限购数量！",1e3),void r.nextTick(function(){l.addCartNum=o})):void 0:($.toast("请输入正确的购买数量",500),void r.nextTick(function(){l.addCartNum=o})):void 0}),$(document).on("click",".icon-close.close-popup",function(){l.addCartNum=1}),$(document).on("click",".em-op-d",function(){l.addCartNum>1&&l.addCartNum--}),$(document).on("click",".em-op-a",function(){return l.total<l.addCartNum+1?void $.toast("超出库存数量！",500):l.limit<l.addCartNum+1?void $.toast("超出限购数量！",500):void l.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=s.product.Skus[t];l.curSkuId=o.SysNo,l.curPrice=o.Price,l.curImg=o.Images[0].ImgUrl})}),$(document).on("pageInit","#page-product-group-detail",function(o,c,e){function n(){$.popup(".popup-cart")}function a(){return""===l.addCartNum?(l.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:l.product.SysNo,skuId:l.curSkuId,qty:l.addCartNum},function(t,o){t?$.toast(t,1e3):d()}),void(l.addCartNum=1))}function d(){t("/cart/get-count-in-cart",{},function(t,o){t||(s.cartNum=o.count)})}var i=u.getSearch(location);if(!i.id)return void(location.href="/");var s=new r({el:"#page-product-group-detail",data:{cartNum:0,product:null,style:[],skuImg:[""],swiper:null},computed:{liked:function(){return this.product.isLike?"已收藏":"收藏"}},methods:{OpenCart:n}}),l=new r({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:a}});d(),t("/product/group-detail",{productId:parseInt(i.id)},function(t,o){if($.hidePreloader(),t)$.toast(t,1e3);else{s.product=u.clone(o.product),l.product=s.product;var c=s.product.Skus;l.curSkuId=c[0].SysNo,l.curPrice=c[0].Price,l.curImg=c[0].Images[0].ImgUrl,s.skuImg.splice(0,s.skuImg.length);for(var e=0;e<c.length;e++)s.style.push(c[e].SizeName),c[e].Images.length>0&&s.skuImg.push(c[e].Images[0].ImgUrl);r.nextTick(function(){s.swiper=new Swiper(".swiper-container",{pagination:".swiper-pagination",paginationClickable:!0,spaceBetween:10,centeredSlides:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}}),$.showPreloader("请稍等"),$(e).on("click",".like",function(){t(s.product.isLike?"/users/del-fav":"/users/add-fav",{productId:parseInt(i.id)},function(t,o){$.hidePreloader(),t?$.toast(t,1e3):s.product.isLike=!s.product.isLike}),s.product.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(e).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),l.$watch("addCartNum",function(t,o){""!==t&&(u.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),r.nextTick(function(){l.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){l.addCartNum=1}),$(document).on("click",".em-op-d",function(){l.addCartNum>1&&l.addCartNum--}),$(document).on("click",".em-op-a",function(){l.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=s.product.Skus[t];l.curSkuId=o.SysNo,l.curPrice=o.Price,l.curImg=o.Images[0].ImgUrl})}),$(document).on("pageInit","#page-product-list",function(c,e,n){function a(){location.href="/product/search?key="+encodeURI(encodeURI(p.searchWord))}function d(t){var o=p.products[t];o.IsShowInCombination?location.href="/product/group-detail?id="+o.SysNo:location.href="/product/detail?id="+o.SysNo}function i(){t("/cart/get-count-in-cart",{},function(t,o){t||(p.cartNum=o.count)})}function s(t){h.product=p.products[t],h.curSkuId=h.product.SkuList[0].SysNo,h.curPrice=h.product.SkuList[0].Price,h.curImg=h.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}function l(){return""===h.addCartNum?(h.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:h.product.SysNo,skuId:h.curSkuId,qty:h.addCartNum},function(t,o){t?$.toast(t,1e3):i()}),void(h.addCartNum=1))}var p=new r({el:"#page-product-list",data:{searchWord:"",products:[],count:0,cartNum:0},methods:{OpenCart:s,goToDetail:d,search:a}}),m=void 0,f=!1;if(i(),"/product/sales"===location.pathname)m=new o("/product/sales",10),m.addItems(function(t,o){$.hidePreloader(),t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))});else if("/product/new"===location.pathname)m=new o("/product/new",10),m.addItems(function(t,o){$.hidePreloader(),t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))});else if("/product/category"===location.pathname){var I=u.getSearch(location);if(!I.CId||!I.ChildCId)return void(location.pathname="/");m=new o("/product/category",10,parseInt(I.CId),parseInt(I.ChildCId)),m.addItems(function(t,o){$.hidePreloader(),t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))})}$.showPreloader("请稍等"),$(n).on("infinite",".infinite-scroll-bottom",function(){f||(f=!0,setTimeout(function(){return f=!1,p.products.length>=p.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(m.addItems(function(t,o){t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))}),void $.refreshScroller())},1e3))});var h=new r({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:l}});$(n).on("click",".icon-clear",function(){p.searchWord=""}),h.$watch("addCartNum",function(t,o){""!==t&&(u.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),r.nextTick(function(){h.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),h.addCartNum=1}),$(document).on("click",".em-op-d",function(){h.addCartNum>1&&h.addCartNum--}),$(document).on("click",".em-op-a",function(){h.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=h.product.SkuList[t];h.curPrice=o.Price,h.curImg=o.Images[0].ImgUrl,h.curSkuId=o.SysNo})}),$(document).on("pageInit","#page-product-group-list",function(c,e,n){function a(t){var o=p.products[t];location.href="/product/group-detail?id="+o.SysNo}function d(){location.href="/product/search?key="+encodeURI(encodeURI(p.searchWord))}function i(){t("/cart/get-count-in-cart",{},function(t,o){t||(p.cartNum=o.count)})}function s(t){I.product=p.products[t],I.curSkuId=I.product.SkuList[0].SysNo,I.curPrice=I.product.SkuList[0].Price,I.curImg=I.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}function l(){return""===I.addCartNum?(I.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:I.product.SysNo,skuId:I.curSkuId,qty:I.addCartNum},function(t,o){t?$.toast(t,1e3):i()}),void(I.addCartNum=1))}var p=new r({el:"#page-product-group-list",data:{searchWord:"",products:[],count:0,cartNum:0},methods:{OpenCart:s,search:d,goToDetail:a}}),m=!1;i();var f=new o("/product/group",10);f.addItems(function(t,o){$.hidePreloader(),t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))}),$.showPreloader("请稍等"),$(n).on("infinite",".infinite-scroll-bottom",function(){m||(m=!0,setTimeout(function(){return m=!1,p.products.length>=p.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(f.addItems(function(t,o){t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))}),void $.refreshScroller())},1e3))}),$(n).on("click",".icon-clear",function(){p.searchWord=""});var I=new r({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:l}});I.$watch("addCartNum",function(t,o){""!==t&&(u.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),r.nextTick(function(){I.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),I.addCartNum=1}),$(document).on("click",".em-op-d",function(){I.addCartNum>1&&I.addCartNum--}),$(document).on("click",".em-op-a",function(){I.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=I.product.SkuList[t];I.curPrice=o.Price,I.curImg=o.Images[0].ImgUrl,I.curSkuId=o.SysNo})}),$(document).on("pageInit","#page-recommend-list",function(c,e,n){function a(t){var o=p.products[t];o.isCombination?location.href="/product/group-detail?id="+o.ProductGroupSysNo:location.href="/product/detail?id="+o.ProductGroupSysNo}function d(){location.href="/product/search?key="+encodeURI(encodeURI(p.searchWord))}function i(){t("/cart/get-count-in-cart",{},function(t,o){t||(p.cartNum=o.count)})}function s(t){h.product=p.products[t],h.curSkuId=h.product.SkuList[0].SysNo,h.curPrice=h.product.SkuList[0].Price,h.curImg=h.product.SkuList[0].ImgUrlList[0].ImgUrl,$.popup(".popup-cart")}function l(){return""===h.addCartNum?(h.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:h.product.ProductGroupSysNo,skuId:h.curSkuId,qty:h.addCartNum},function(t,o){t?$.toast(t,1e3):i()}),void(h.addCartNum=1))}var p=new r({el:"#page-recommend-list",data:{searchWord:"",products:[],count:0,cartNum:0},methods:{OpenCart:s,search:d,goToDetail:a}}),m=!1,f=u.getSearch(location);if(!f.id)return void(location.pathname="/");i();var I=new o("/product/recommend",10,parseInt(f.id));I.addItems(function(t,o){$.hidePreloader(),t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))}),$.showPreloader("请稍等"),$(n).on("infinite",".infinite-scroll-bottom",function(){m||(m=!0,setTimeout(function(){return m=!1,p.products.length>=p.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(I.addItems(function(t,o){t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))}),void $.refreshScroller())},1e3))}),$(n).on("click",".icon-clear",function(){p.searchWord=""});var h=new r({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:l}});h.$watch("addCartNum",function(t,o){""!==t&&(u.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),r.nextTick(function(){h.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),h.addCartNum=1}),$(document).on("click",".em-op-d",function(){h.addCartNum>1&&h.addCartNum--}),$(document).on("click",".em-op-a",function(){h.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=h.product.SkuList[t];h.curPrice=o.Price,h.curImg=o.ImgUrlList[0].ImgUrl,h.curSkuId=o.SysNo})}),$(document).on("pageInit","#page-product-flash-deal-list",function(c,n,a){function d(){location.href="/product/search?key="+encodeURI(encodeURI(I.searchWord))}function i(){t("/cart/get-count-in-cart",{},function(t,o){t||(I.cartNum=o.count)})}function s(t){var o=I.products[t];return 1!==o.killStatus&&2!==o.killStatus||o.TotalCount<=0?!1:void(location.href="/product/secKill-detail?id="+o.SysNo)}function l(t){h.product=I.products[t],$.popup(".popup-cart")}function p(){return""===h.addCartNum?(h.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:h.product.ProductSysNo,skuId:h.product.SkuSysNo,qty:h.addCartNum},function(t,o){t?$.toast(t,1e3):i()}),void(h.addCartNum=1))}function m(t){if(t.RemainStartTotalSeconds>0)t.RemainStartTotalSeconds-=1e3,t.remainStart=e(t.RemainStartTotalSeconds);else{t.killStatus=1;var o=new Date(t.EndTime).getTime(),c=(new Date).getTime();t.RemainEndTotalSeconds=o-c}}function f(t){t.RemainEndTotalSeconds>0?(t.RemainEndTotalSeconds-=1e3,t.remainEnd=e(t.RemainEndTotalSeconds)):t.killStatus=0}var I=new r({el:"#page-product-flash-deal-list",data:{searchWord:"",cartNum:0,count:0,products:[]},methods:{goToDetail:s,OpenCart:l,addToCart:p,search:d}}),h=new r({el:"#popup-cart",data:{addCartNum:1,product:null},methods:{addToCart:p}});i();var g=new o("/product/secKill",10);g.addItems(function(t,o){if($.hidePreloader(),t)$.toast(t,1e3);else{I.count=o.count;for(var c=o.products,r=c.length,u=null,n=0;r>n;n++)u=c[n],u.RemainStartTotalSeconds=1e3*parseInt(u.RemainStartTotalSeconds),u.RemainEndTotalSeconds=1e3*parseInt(u.RemainEndTotalSeconds),u.RemainStartTotalSeconds<1&&u.RemainEndTotalSeconds>1?(u.killStatus=1,u.remainEnd=e(u.RemainEndTotalSeconds)):u.RemainStartTotalSeconds>1&&u.RemainEndTotalSeconds<1?(u.killStatus=2,u.remainStart=e(u.RemainStartTotalSeconds)):u.killStatus=0;I.products=I.products.concat(o.products)}}),$.showPreloader("请稍等"),setInterval(function(){for(var t=I.products,o=t.length,c=null,e=0;o>e;e++)c=t[e],1===c.killStatus?f(c):2===c.killStatus&&m(c)},1e3),$(a).on("click",".icon-clear",function(){I.searchWord=""}),h.$watch("addCartNum",function(t,o){return""!==t?(u.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),r.nextTick(function(){h.addCartNum=o})),t>h.product.TotalCount?($.toast("超出库存数量！",1e3),void r.nextTick(function(){h.addCartNum=o})):t>h.product.LimitBuyCount?($.toast("超出限购数量！",1e3),void r.nextTick(function(){h.addCartNum=o})):void 0):void 0}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),h.addCartNum=1}),$(document).on("click",".em-op-d",function(){h.addCartNum>1&&h.addCartNum--}),$(document).on("click",".em-op-a",function(){return h.addCartNum+1>h.product.TotalCount?void $.toast("超出库存数量！",1e3):h.addCartNum+1>h.product.LimitBuyCount?void $.toast("超出限购数量！",1e3):void h.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){})}),$(document).on("pageInit","#page-product-search",function(o,e,n){function a(){m=null,f=!1,m=new c("/product/search",10,p.searchWord),m.addItems(function(t,o){$.hidePreloader(),t?$.toast(t,1e3):(p.count=o.count,p.products.splice(0,p.products.length),p.products=p.products.concat(o.products))}),$.showPreloader("请稍等")}function d(){t("/cart/get-count-in-cart",{},function(t,o){t||(p.cartNum=o.count)})}function i(t){var o=p.products[t];o.IsShowInCombination?location.href="/product/group-detail?id="+o.SysNo:location.href="/product/detail?id="+o.SysNo}function s(t){h.product=p.products[t],h.curSkuId=h.product.SkuList[0].SysNo,h.curPrice=h.product.SkuList[0].Price,h.curImg=h.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}function l(){return""===h.addCartNum?(h.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:h.product.SysNo,skuId:h.curSkuId,qty:h.addCartNum},function(t,o){t?$.toast(t,1e3):d()}),void(h.addCartNum=1))}var p=new r({el:"#page-product-search",data:{searchWord:"",cartNum:0,products:[],count:0},methods:{OpenCart:s,goToDetail:i,search:a}}),m=void 0,f=!1,I=u.getSearch(location);I.key&&(p.searchWord=decodeURI(I.key)),d(),m=new c("/product/search",10,p.searchWord),m.addItems(function(t,o){$.hidePreloader(),t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))}),$.showPreloader("请稍等"),$(n).on("infinite",".infinite-scroll-bottom",function(){f||(f=!0,setTimeout(function(){return f=!1,p.products.length>=p.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(m.addItems(function(t,o){t?$.toast(t,1e3):(p.count=o.count,p.products=p.products.concat(o.products))}),void $.refreshScroller())},1e3))});var h=new r({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:"",curSkuId:0},methods:{addToCart:l}});$(n).on("click",".icon-clear",function(){p.searchWord=""}),h.$watch("addCartNum",function(t,o){""!==t&&(u.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),r.nextTick(function(){h.addCartNum=o})))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),h.addCartNum=1}),$(document).on("click",".em-op-d",function(){h.addCartNum>1&&h.addCartNum--}),$(document).on("click",".em-op-a",function(){h.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),o=h.product.SkuList[t];h.curPrice=o.Price,h.curImg=o.Images[0].ImgUrl,h.curSkuId=o.SysNo})}),$.init()})}();