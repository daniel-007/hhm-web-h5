!function(){function t(t,c,o){$.ajax({type:"POST",url:t,data:c,timeout:15e3,success:function(t,c,e){t.status?o(null,t):o(t.msg,null)},error:function(c,e,n){console.error(t+" error: "+e+"##"+n),o("服务异常",null)}})}function c(c,o,e,n){var a={};return a.url=c,a.cid=e||0,a.childId=n||0,a.pageSize=o,a.pageId=0,a.addItems=function(c){var o=this;t(this.url,{CId:a.cid,ChildCId:a.childId,pageId:this.pageId,pageSize:this.pageSize},function(t,e){t?c(t,null):(o.pageId++,c(null,e))})},a}function o(t){var c=Math.floor(t/36e5),o=Math.floor(t%864e5%36e5/6e4),e=Math.floor(t%864e5%36e5%6e4/1e3);return c=c>9?c:"0"+c,o=o>9?o:"0"+o,e=e>9?e:"0"+e,c+":"+o+":"+e}require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(e,n){"use strict";e.config.delimiters=["${","}"],e.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-product-class",function(c,o,n){var a=new e({el:"#page-product-class",data:{categories:[],search:"",message:0}});t("/users/get-notice-count",{},function(t,c){t||(a.message=c.count)}),t("/product/class",{},function(t,c){t?$.toast(t,1e3):a.categories=c.category.slice()}),$(n).on("click",".icon-clear",function(){a.search=""})}),$(document).on("pageInit","#page-product-detail",function(c,o,a){function u(){$.popup(".popup-cart")}var r=n.getSearch(location);if(!r.id)return void(location.pathname="/");var i=new e({el:"#page-product-detail",data:{isLike:!1,cartNum:0,product:null,style:[],skuImg:[]},computed:{liked:function(){return this.isLike?"已收藏":"收藏"}},methods:{addToCart:u}}),d=new e({el:"#popup-cart",data:{addCartNum:1,curPrice:0,curImg:"",product:null}});t("/cart/get-count-in-cart",{},function(t,c){t||(i.cartNum=c.count)}),t("/product/detail",{productId:parseInt(r.id)},function(t,c){if(t)$.toast(t,1e3);else{i.product=n.clone(c.product),d.product=i.product;var o=i.product.Skus;d.curPrice=o[0].Price,d.curImg=o[0].Images[0].ImgUrl;for(var e=0;e<o.length;e++)i.style.push(o[e].SizeName),o[e].Images.length>0&&i.skuImg.push(o[e].Images[0].ImgUrl)}}),$(a).on("click",".like",function(){t(i.isLike?"/users/del-fav":"/users/add-fav",{productId:parseInt(r.id)},function(t,c){$.hidePreloader(),t?$.toast(t,1e3):i.isLike=!i.isLike}),i.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(a).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),d.$watch("addCartNum",function(t,c){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){d.addCartNum=c})))}),$(document).on("click",".my-a-cart.close-popup",function(t){return""===d.addCartNum?(d.addCartNum=1,$.toast("请输入正确的购买数量",1e3),void t.preventDefault()):(i.cartNum+=parseInt(d.addCartNum),void(d.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){d.addCartNum=1}),$(document).on("click",".em-op-d",function(){d.addCartNum>1&&d.addCartNum--}),$(document).on("click",".em-op-a",function(){d.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),c=i.product.Skus[t];d.curPrice=c.Price,d.curImg=c.Images[0].ImgUrl}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-secKill-product-detail",function(c,o,a){function u(){$.popup(".popup-cart")}var r=n.getSearch(location);if(!r.id)return void(location.pathname="/");var i=new e({el:"#page-secKill-product-detail",data:{isLike:!1,cartNum:0,product:null,style:[],skuImg:[]},computed:{liked:function(){return this.isLike?"已收藏":"收藏"}},methods:{addToCart:u}}),d=new e({el:"#popup-cart",data:{addCartNum:1,curPrice:0,curImg:"",product:null}});t("/cart/get-count-in-cart",{},function(t,c){t||(i.cartNum=c.count)}),t("/product/secKill-detail",{productId:parseInt(r.id)},function(t,c){if(t)$.toast(t,1e3);else{i.product=n.clone(c.product),d.product=i.product,d.curPrice=i.product.SeckillPrice;var o=i.product.Skus;d.curImg=o[0].Images[0].ImgUrl;for(var e=0;e<o.length;e++)i.style.push(o[e].SizeName),o[e].Images.length>0&&i.skuImg.push(o[e].Images[0].ImgUrl)}}),$(a).on("click",".like",function(){t(i.isLike?"/users/del-fav":"/users/add-fav",{productId:parseInt(r.id)},function(t,c){$.hidePreloader(),t?$.toast(t,1e3):i.isLike=!i.isLike}),i.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(a).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),d.$watch("addCartNum",function(t,c){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){d.addCartNum=c})))}),$(document).on("click",".my-a-cart.close-popup",function(t){return""===d.addCartNum?(d.addCartNum=1,$.toast("请输入正确的购买数量",1e3),void t.preventDefault()):(i.cartNum+=parseInt(d.addCartNum),void(d.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){d.addCartNum=1}),$(document).on("click",".em-op-d",function(){d.addCartNum>1&&d.addCartNum--}),$(document).on("click",".em-op-a",function(){d.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),c=i.product.Skus[t];d.curPrice=c.Price,d.curImg=c.Images[0].ImgUrl}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-product-group-detail",function(c,o,a){function u(){$.popup(".popup-cart")}var r=n.getSearch(location);if(!r.id)return void(location.pathname="/");var i=new e({el:"#page-product-group-detail",data:{isLike:!1,cartNum:0,product:null,style:[],skuImg:[]},computed:{liked:function(){return this.isLike?"已收藏":"收藏"}},methods:{addToCart:u}}),d=new e({el:"#popup-cart",data:{addCartNum:1,curPrice:0,curImg:"",product:null}});t("/cart/get-count-in-cart",{},function(t,c){t||(i.cartNum=c.count)}),t("/product/group-detail",{productId:parseInt(r.id)},function(t,c){if(t)$.toast(t,1e3);else{i.product=n.clone(c.product),d.product=i.product;var o=i.product.Skus;d.curPrice=o[0].Price,d.curImg=o[0].Images[0].ImgUrl;for(var e=0;e<o.length;e++)i.style.push(o[e].SizeName),o[e].Images.length>0&&i.skuImg.push(o[e].Images[0].ImgUrl)}}),$(a).on("click",".like",function(){t(i.isLike?"/users/del-fav":"/users/add-fav",{productId:parseInt(r.id)},function(t,c){$.hidePreloader(),t?$.toast(t,1e3):i.isLike=!i.isLike}),i.isLike?$.showPreloader("取消收藏..."):$.showPreloader("收藏...")}),$(a).on("click",".my-back-top",function(){$(".content").scrollTop(0)}),d.$watch("addCartNum",function(t,c){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){d.addCartNum=c})))}),$(document).on("click",".my-a-cart.close-popup",function(t){return""===d.addCartNum?(d.addCartNum=1,$.toast("请输入正确的购买数量",1e3),void t.preventDefault()):(i.cartNum+=parseInt(d.addCartNum),void(d.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){d.addCartNum=1}),$(document).on("click",".em-op-d",function(){d.addCartNum>1&&d.addCartNum--}),$(document).on("click",".em-op-a",function(){d.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),c=i.product.Skus[t];d.curPrice=c.Price,d.curImg=c.Images[0].ImgUrl}),$(function(){$(".swiper-container").swiper({spaceBetween:30,continuous:!0,autoplay:2500,autoplayDisableOnInteraction:!1})})}),$(document).on("pageInit","#page-product-list",function(o,a,u){function r(){t("/cart/get-count-in-cart",{},function(t,c){t||(s.cartNum=c.count)})}function i(t){f.product=s.products[t],f.curPrice=f.product.SkuList[0].Price,f.curImg=f.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}function d(c,o){return console.log(c),""===f.addCartNum?(f.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(t("/cart/add-to-cart",{productId:c,skuId:o,qty:f.addCartNum},function(t,c){t?$.toast(t,1e3):r()}),f.addCartNum=1,void(f.product=null))}var s=new e({el:"#page-product-list",data:{search:"",products:[],count:0,cartNum:0},methods:{OpenCart:i}}),l=void 0,p=!1;if(r(),"/product/sales"===location.pathname)l=new c("/product/sales",10),l.addItems(function(t,c){t?$.toast(t,1e3):(s.count=c.count,s.products=s.products.concat(c.products))});else if("/product/new"===location.pathname)l=new c("/product/new",10),l.addItems(function(t,c){t?$.toast(t,1e3):(s.count=c.count,s.products=s.products.concat(c.products))});else if("/product/category"===location.pathname){var m=n.getSearch(location);if(!m.CId||!m.ChildCId)return void(location.pathname="/");l=new c("/product/category",10,parseInt(m.CId),parseInt(m.ChildCId)),l.addItems(function(t,c){t?$.toast(t,1e3):(s.count=c.count,s.products=s.products.concat(c.products))})}$(u).on("infinite",".infinite-scroll-bottom",function(){p||(p=!0,setTimeout(function(){return p=!1,s.products.length>=s.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(l.addItems(function(t,c){t?$.toast(t,1e3):(s.count=c.count,s.products=s.products.concat(c.products))}),void $.refreshScroller())},1e3))});var f=new e({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:""},methods:{addToCart:d}});$(u).on("click",".icon-clear",function(){s.search=""}),f.$watch("addCartNum",function(t,c){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){f.addCartNum=c})))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),f.addCartNum=1,f.product=null}),$(document).on("click",".em-op-d",function(){f.addCartNum>1&&f.addCartNum--}),$(document).on("click",".em-op-a",function(){f.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),c=f.product.SkuList[t];f.curPrice=c.Price,f.curImg=c.Images[0].ImgUrl})}),$(document).on("pageInit","#page-product-group-list",function(o,a,u){function r(t){l.product=i.products[t],l.curPrice=l.product.SkuList[0].Price,l.curImg=l.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}var i=new e({el:"#page-product-group-list",data:{search:"",products:[],count:0,cartNum:0},methods:{addToCart:r}}),d=!1;t("/cart/get-count-in-cart",{},function(t,c){t||(i.cartNum=c.count)});var s=new c("/product/group",10);s.addItems(function(t,c){t?$.toast(t,1e3):(i.count=c.count,i.products=i.products.concat(c.products))}),$(u).on("infinite",".infinite-scroll-bottom",function(){d||(d=!0,setTimeout(function(){return d=!1,i.products.length>=i.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(s.addItems(function(t,c){t?$.toast(t,1e3):(i.count=c.count,i.products=i.products.concat(c.products))}),void $.refreshScroller())},1e3))}),$(u).on("click",".icon-clear",function(){i.search=""});var l=new e({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:""}});l.$watch("addCartNum",function(t,c){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){l.addCartNum=c})))}),$(document).on("click",".my-a-cart.close-popup",function(t){return t.preventDefault(),""===l.addCartNum?(l.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(i.cartNum+=parseInt(l.addCartNum),l.addCartNum=1,void(l.product=null))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),l.addCartNum=1,l.product=null}),$(document).on("click",".em-op-d",function(){l.addCartNum>1&&l.addCartNum--}),$(document).on("click",".em-op-a",function(){l.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),c=l.product.SkuList[t];l.curPrice=c.Price,l.curImg=c.Images[0].ImgUrl})}),$(document).on("pageInit","#page-recommend-list",function(o,a,u){function r(t){p.product=i.products[t],p.curPrice=p.product.SkuList[0].Price,p.curImg=p.product.SkuList[0].Images[0].ImgUrl,$.popup(".popup-cart")}var i=new e({el:"#page-recommend-list",data:{search:"",products:[],count:0,cartNum:0},methods:{addToCart:r}}),d=!1,s=n.getSearch(location);if(!s.id)return void(location.pathname="/");t("/cart/get-count-in-cart",{},function(t,c){t||(i.cartNum=c.count)});var l=new c("/product/recommend",10,parseInt(s.id));l.addItems(function(t,c){t?$.toast(t,1e3):(i.count=c.count,console.log("data:"+JSON.stringify(c)),i.products=i.products.concat(c.products))}),$(u).on("infinite",".infinite-scroll-bottom",function(){d||(d=!0,setTimeout(function(){return d=!1,i.products.length>=i.count?($.detachInfiniteScroll($(".infinite-scroll")),void $(".infinite-scroll-preloader").remove()):(l.addItems(function(t,c){t?$.toast(t,1e3):(i.count=c.count,i.products=i.products.concat(c.products))}),void $.refreshScroller())},1e3))}),$(u).on("click",".icon-clear",function(){i.search=""});var p=new e({el:"#popup-cart",data:{addCartNum:1,product:null,curPrice:0,curImg:""}});p.$watch("addCartNum",function(t,c){""!==t&&(n.isPositiveNum(t)||($.toast("请输入正确的购买数量",500),e.nextTick(function(){p.addCartNum=c})))}),$(document).on("click",".my-a-cart.close-popup",function(t){return t.preventDefault(),""===p.addCartNum?(p.addCartNum=1,void $.toast("请输入正确的购买数量",1e3)):(i.cartNum+=parseInt(p.addCartNum),p.addCartNum=1,void(p.product=null))}),$(document).on("click",".icon-close.close-popup",function(){event.preventDefault(),p.addCartNum=1,p.product=null}),$(document).on("click",".em-op-d",function(){p.addCartNum>1&&p.addCartNum--}),$(document).on("click",".em-op-a",function(){p.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on");var t=$(this).val(),c=p.product.SkuList[t];p.curPrice=c.Price,p.curImg=c.Images[0].ImgUrl})}),$(document).on("pageInit","#page-product-flash-deal-list",function(t,n,a){function u(t){if(t.RemainStartTotalSeconds>0)t.RemainStartTotalSeconds-=1e3,t.remainStart=o(t.RemainStartTotalSeconds);else{t.killStatus=1;var c=new Date(t.EndTime).getTime(),e=(new Date).getTime();t.RemainEndTotalSeconds=c-e}}function r(t){t.RemainEndTotalSeconds>0?(t.RemainEndTotalSeconds-=1e3,t.remainEnd=o(t.RemainEndTotalSeconds)):t.killStatus=0}var i=new e({el:"#page-product-flash-deal-list",data:{search:"",count:0,products:[]}}),d=new c("/product/secKill",10);d.addItems(function(t,c){if(t)$.toast(t,1e3);else{i.count=c.count;for(var e=c.products,n=e.length,a=null,u=0;n>u;u++)a=e[u],a.RemainStartTotalSeconds=1e3*parseInt(a.RemainStartTotalSeconds),a.RemainEndTotalSeconds=1e3*parseInt(a.RemainEndTotalSeconds),a.RemainEndTotalSeconds>0?(a.killStatus=1,a.remainEnd=o(a.RemainEndTotalSeconds)):a.RemainStartTotalSeconds>0?(a.killStatus=2,a.remainStart=o(a.RemainStartTotalSeconds)):a.killStatus=0;i.products=i.products.concat(c.products)}}),setInterval(function(){for(var t=i.products,c=t.length,o=null,e=0;c>e;e++)if(o=t[e],1===o.killStatus)r(o);else{if(2!==o.killStatus)continue;u(o)}},1e3),$(a).on("click",".icon-clear",function(){i.search=""})}),$.init()})}();