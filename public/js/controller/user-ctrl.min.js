!function(){function e(e,t,n){$.ajax({type:"POST",url:e,data:t,timeout:15e3,success:function(e,t,a){e.status?n(null,e):n(e.msg,null)},error:function(t,a,o){console.error(e+" error: "+a+"##"+o),n("服务异常",null)}})}function t(t){e("/users/getStoreName",{},function(e,n){t(e,n.storeName)})}require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(n,a){"use strict";n.config.delimiters=["${","}"],n.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-my",function(e,a,o){var r=new n({el:"#page-my",data:{storeName:""}});t(function(e,t){e?$.toast(e,1e3):r.storeName=t})}),$(document).on("pageInit","#page-my-account",function(e,a,o){var r=new n({el:"#page-my-account",data:{storeName:""}});t(function(e,t){e?$.toast(e,1e3):r.storeName=t}),$(o).on("click","#linkName",function(){location.href="/users/change-shop-name"}),$(o).on("click","#linkAddress",function(){location.href="/users/my-address"}),$(o).on("click","#linkPassword",function(){location.href="/users/change-password"})}),$(document).on("pageInit","#page-change-shop-name",function(a,o,r){function s(t){e("/users/setStoreName",{storeName:c.storeName},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href="/users/account"}),$.showPreloader("保存中")}var c=new n({el:"#page-change-shop-name",data:{storeName:""},methods:{setStoreName:s}});t(function(e,t){e?$.toast(e,1e3):c.storeName=t})}),$(document).on("pageInit","#page-change-password",function(t,a,o){function r(t){if(!s.isDisable){if(s.newPW!=s.rePW)return void $.toast("密码输入不一致");e("/users/change-password",{password:s.newPW},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):($.toast("新密码设置成功！",1e3),location.href="/users/account")}),$.showPreloader("保存中")}}var s=new n({el:"#page-change-password",data:{oldPW:"",newPW:"",rePW:""},computed:{isDisable:function(){return 0===this.oldPW.length||0===this.newPW.length||0===this.rePW.length}},method:{changePW:r}})}),$(document).on("pageInit","#page-my-buy-report",function(e,t,o){var r=a.dateFormat(new Date,"yyyy-MM-dd"),s=new n({el:"#page-my-buy-report",data:{start:r,end:r}});$(o).on("click",".button",function(){$.router.load("/users/buy-report-result")}),$("#my-start-time").calendar({value:[s.start]}),$("#my-end-time").calendar({value:[s.end]})}),$(document).on("pageInit","#page-my-buy-report-result",function(e,t,a){new n({el:"#page-my-buy-report-result",data:{}})}),$(document).on("pageInit","#page-my-fav",function(e,t,o){var r=new n({el:"#page-my-fav",data:{search:"",cartNum:30}});$(o).on("click",".icon-clear",function(){r.search=""}),$(o).on("click",".like",function(){$(this).toggleClass("icon-like"),$(this).toggleClass("icon-likeactive"),$(this).hasClass("icon-like")?$(this).children("span").text("收藏"):$(this).children("span").text("已收藏")}),$(o).on("click",".icon-clear",function(){r.search=""}),$(o).on("click",".button",function(){$.popup(".popup-cart")});var s=new n({el:"#popup-cart",data:{addCartNum:1}});s.$watch("addCartNum",function(e,t){""!==e&&(a.isPositiveNum(e)||($.toast("请输入正确的购买数量",500),n.nextTick(function(){s.addCartNum=t})))}),$(document).on("click",".my-a-cart.close-popup",function(){return""===s.addCartNum?(s.addCartNum=1,$.toast("请输入正确的购买数量",1e3),void e.preventDefault()):(r.cartNum+=parseInt(s.addCartNum),void(s.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){s.addCartNum=1}),$(document).on("click",".em-op-d",function(){s.addCartNum>1&&s.addCartNum--}),$(document).on("click",".em-op-a",function(){s.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on")})}),$(document).on("pageInit","#page-my-message",function(e,t,a){new n({el:"#page-my-message",data:{}});$(a).on("click",".open-message-modal",function(){$.modal({title:'消息标题消息标题消息标题消息标题消息标题消息标题消息标题<span class="my-message-time">今天 09:45</span>',text:"<p>又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！<p>",extraClass:"my-dialog",buttons:[{text:'<a href="#" class="icon icon-close my-black-text"></a>'}]})})}),$(document).on("pageInit","#page-my-address",function(t,a,o){function r(t,n){$.confirm("确定删除该地址吗?",function(){e("/address/del-receiver",{receiverId:s.receivers[t].receiverId},function(e,n){e?$.toast(e,1e3):s.receivers.splice(t,1)})},function(){})}var s=new n({el:"#page-my-address",data:{receivers:[],defaultIdx:null},methods:{deleteAdr:r}});e("/address/get-all-receiver",{},function(e,t){if(e)$.toast(e,1e3);else for(var n=t.receiver,a=n.length,o=0;a>o;o++){var r={};r.receiverId=n[o].SysNo,r.phone=n[o].ReceiverPhone,r.receiver=n[o].ReceiverName,r.pcdDes=n[o].Province+" "+n[o].City+" "+n[o].District,r.address=n[o].Address,r.isDefault=n[o].IsDefault,s.receivers.push(r)}}),$(o).on("change",'[name="single-radio"]',function(){e("/address/set-default-receiver",{receiverId:s.receivers[s.defaultIdx].receiverId},function(e,t){if(e)$.toast(e,1e3);else{for(var n=s.receivers.length,a=0;n>a;a++)a===s.defaultIdx?s.receivers[a].isDefault=!0:s.receivers[a].isDefault=!1;$.hidePreloader()}}),$.showPreloader("保存中")})}),$.init()})}();