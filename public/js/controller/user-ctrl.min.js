+function(){function e(e,t,a){$.ajax({type:"POST",url:e,data:t,timeout:15e3,success:function(e,t,r){e.status?a(null,e):a(e.msg,null)},error:function(t,r,n){console.error(e+" error: "+r+"##"+n),a("服务异常",null)}})}function t(t){e("/users/getStoreName",{},function(e,a){t(e,a.storeName)})}require.config({baseUrl:"../js",paths:{Vue:"./lib/vue.min",Utils:"./lib/utils"},shim:{Vue:{exports:"Vue"},Utils:{exports:"Utils"}}}),require(["Vue","Utils"],function(a,r){"use strict";a.config.delimiters=["${","}"],a.config.unsafeDelimiters=["{!!","!!}"],$(document).on("pageInit","#page-my",function(e,r,n){var o=new a({el:"#page-my",data:{storeName:""}});t(function(e,t){e?$.toast(e,1e3):o.storeName=t})}),$(document).on("pageInit","#page-my-account",function(e,r,n){var o=new a({el:"#page-my-account",data:{storeName:""}});t(function(e,t){e?$.toast(e,1e3):o.storeName=t}),$(n).on("click","#linkName",function(){location.href="/users/change-shop-name"}),$(n).on("click","#linkAddress",function(){location.href="/users/my-address"}),$(n).on("click","#linkPassword",function(){location.href="/users/change-password"})}),$(document).on("pageInit","#page-change-shop-name",function(r,n,o){function s(t){e("/users/setStoreName",{storeName:i.storeName},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):location.href="/users/account"}),$.showPreloader("保存中")}var i=new a({el:"#page-change-shop-name",data:{storeName:""},methods:{setStoreName:s}});t(function(e,t){e?$.toast(e,1e3):i.storeName=t})}),$(document).on("pageInit","#page-change-password",function(t,r,n){function o(t){if(!s.isDisable){if(s.newPW!=s.rePW)return void $.toast("密码输入不一致");e("/users/change-password",{password:s.newPW},function(e,t){$.hidePreloader(),e?$.toast(e,1e3):($.toast("新密码设置成功！",1e3),location.href="/users/account")}),$.showPreloader("保存中")}}var s=new a({el:"#page-change-password",data:{oldPW:"",newPW:"",rePW:""},computed:{isDisable:function(){return 0===this.oldPW.length||0===this.newPW.length||0===this.rePW.length}},method:{changePW:o}})}),$(document).on("pageInit","#page-my-buy-report",function(e,t,n){var o=r.dateFormat(new Date,"yyyy-MM-dd"),s=new a({el:"#page-my-buy-report",data:{start:o,end:o}});$(n).on("click",".button",function(){$.router.load("/users/buy-report-result")}),$("#my-start-time").calendar({value:[s.start]}),$("#my-end-time").calendar({value:[s.end]})}),$(document).on("pageInit","#page-my-buy-report-result",function(e,t,r){new a({el:"#page-my-buy-report-result",data:{}})}),$(document).on("pageInit","#page-my-fav",function(e,t,n){var o=new a({el:"#page-my-fav",data:{search:"",cartNum:30}});$(n).on("click",".icon-clear",function(){o.search=""}),$(n).on("click",".like",function(){$(this).toggleClass("icon-like"),$(this).toggleClass("icon-likeactive"),$(this).hasClass("icon-like")?$(this).children("span").text("收藏"):$(this).children("span").text("已收藏")}),$(n).on("click",".icon-clear",function(){o.search=""}),$(n).on("click",".button",function(){$.popup(".popup-cart")});var s=new a({el:"#popup-cart",data:{addCartNum:1}});s.$watch("addCartNum",function(e,t){""!==e&&(r.isPositiveNum(e)||($.toast("请输入正确的购买数量",500),a.nextTick(function(){s.addCartNum=t})))}),$(document).on("click",".my-a-cart.close-popup",function(){return""===s.addCartNum?(s.addCartNum=1,$.toast("请输入正确的购买数量",1e3),void e.preventDefault()):(o.cartNum+=parseInt(s.addCartNum),void(s.addCartNum=1))}),$(document).on("click",".icon-close.close-popup",function(){s.addCartNum=1}),$(document).on("click",".em-op-d",function(){s.addCartNum>1&&s.addCartNum--}),$(document).on("click",".em-op-a",function(){s.addCartNum++}),$(document).on("click",".my-ul-spec li",function(){$(".my-ul-spec li").removeClass("my-spec-on"),$(this).addClass("my-spec-on")})}),$(document).on("pageInit","#page-my-message",function(e,t,r){new a({el:"#page-my-message",data:{}});$(r).on("click",".open-message-modal",function(){$.modal({title:'消息标题消息标题消息标题消息标题消息标题消息标题消息标题<span class="my-message-time">今天 09:45</span>',text:"<p>又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！又到了周四大特卖！还在等什么呢！手快有，手慢无，赶紧抢货咯！<p>",extraClass:"my-dialog",buttons:[{text:'<a href="#" class="icon icon-close my-black-text"></a>'}]})})}),$(document).on("pageInit","#page-my-address",function(t,r,n){function o(t,a){$.confirm("确定删除该地址吗?",function(){e("/address/del-receiver",{receiverId:i.receivers[t].receiverId},function(e,a){e?$.toast(e,1e3):i.receivers.splice(t,1)})},function(){})}function s(e){if(e>=0){$("title").text("修改地址-好好卖");var t=i.receivers[e];c=new a({el:"#popup-adr",data:{index:e,receiverId:t.receiverId,phone:t.phone,receiver:t.receiver,pcdDes:t.pcdDes,address:t.address,isDefault:t.isDefault}})}else c=new a({el:"#popup-adr",data:{index:-1,receiverId:0,phone:"",receiver:"",pcdDes:"浙江省 嘉兴市 南湖区",address:"",isDefault:!1}}),$("title").text("新增地址-好好卖");$("#city-picker").cityPicker({toolbarTemplate:'<header class="bar bar-nav"><button class="button button-link pull-right close-picker">确定</button>        <h1 class="title">选择收货地址</h1></header>'}),$.popup(".popup-adr")}var i=new a({el:"#page-my-address",data:{receivers:[],defaultIdx:null,OPAdr:null},methods:{deleteAdr:o,addOrEditAdr:s}}),c=void 0;e("/address/get-all-receiver",{},function(e,t){if(e)$.toast(e,1e3);else for(var a=t.receiver,r=a.length,n=0;r>n;n++){var o={};o.receiverId=a[n].SysNo,o.phone=a[n].ReceiverPhone,o.receiver=a[n].ReceiverName,o.pcdDes=a[n].Province+" "+a[n].City+" "+a[n].District,o.address=a[n].Address,o.isDefault=a[n].IsDefault,i.receivers.push(o)}}),$(document).on("click",".close-popup",function(t){t.preventDefault();var a="/address/modify-receiver";0===c.receiverId&&(a="/address/add-receiver"),e(a,{receiverId:c.receiverId,phone:c.phone,receiver:c.receiver,pcdDes:c.pcdDes,address:c.address,isDefault:c.isDefault},function(e,t){if($.hidePreloader(),e)$.toast(e,1e3);else{var a=void 0;-1===c.index?(a={},a.receiverId=t.receiverId,a.phone=c.phone,a.receiver=c.receiver,a.pcdDes=c.pcdDes,a.address=c.address,a.isDefault=c.isDefault,i.receivers.push(a)):(a=i.receivers[c.index],a.phone=c.phone,a.receiver=c.receiver,a.pcdDes=c.pcdDes,a.address=c.address,a.isDefault=c.isDefault),c.$destroy()}}),$.showPreloader("请稍等"),$("title").text("地址管理-好好卖")}),$(n).on("change",'[name="single-radio"]',function(){e("/address/set-default-receiver",{receiverId:i.receivers[i.defaultIdx].receiverId},function(e,t){if(e)$.toast(e,1e3);else{for(var a=i.receivers.length,r=0;a>r;r++)r===i.defaultIdx?i.receivers[r].isDefault=!0:i.receivers[r].isDefault=!1;$.hidePreloader()}}),$.showPreloader("保存中")})}),$.init()})}();